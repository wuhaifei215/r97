<?php
/* -------------------------------------------------
   1️⃣ 强制把模块参数写入请求数组
        必须在加载 ThinkPHP 之前完成
   ------------------------------------------------- */
if (empty($_GET['g'])) {
    // 把模块标记写入 GET/REQUEST，兼容 GET、POST、CLI 等所有请求方式
    $_GET['g']     = 'Pay';
    $_REQUEST['g'] = 'Pay';
}

/* -------------------------------------------------
   2️⃣ 定义 Application 目录（指向 /Application/）
   ------------------------------------------------- */
if (!defined('APP_PATH')) {
    // 本文件假设在站点根目录的子目录 /api/
    // dirname(__DIR__) 返回站点根目录，例如 /var/www/html
    define('APP_PATH', dirname(__DIR__) . '/Application/');
}

/* -------------------------------------------------
   3️⃣ 加载 ThinkPHP 正确入口
   ------------------------------------------------- */
require dirname(__DIR__) . '/core/ThinkPHP.php';   // ← 你的入口文件路径

/* -------------------------------------------------
   4️⃣ 调用 Pay 模块下 TreealPay 控制器的 notifyurl 方法
        使用完整路由 R()，即使 MODULE_NAME 仍是默认也会强制使用 Pay
   ------------------------------------------------- */
R('Pay/TreealPay/notifyurl');

/* -------------------------------------------------
   5️⃣ 结束脚本，防止框架继续渲染默认模板
   ------------------------------------------------- */
exit;
